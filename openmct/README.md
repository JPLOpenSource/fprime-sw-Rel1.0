# Fprime OpenMCT Server

Expands on the openmct-telemetry-server to provide visualizations for binary
data streams. The OpenMCT server consumes a stream of BSON data, publishes it to
clients in real time, and also stores it in a database for historical access later.
This deployment also runs an adapter to convert fprime binary packets to BSON.
OpenMCT also ships with plugins to use Apache CouchDB for layout persistence.
Telemetry visualization will work without configuring CouchDB, but any layouts or
other user-created resources cannot be saved.

## Usage

Make sure node.js and npm (https://nodejs.org/en/) are installed on your system,
then run:

```
npm install
```
(Optional): This package ships with a frozen version of the node modules needed
to run the server, but running npm install will update packages if more recent
versions are available.

```
npm run configure
```
Runs autocoders and scripts to generate a JSON dictionary and configuration
files, which needed by the OpenMCT server and adapter to interpret binary
packets.

```
npm start
```
Starts the OpenMCT telemetry server, web client server, and BSON Adapter. By
default the web client is served on localhost:8000

```
npm run clean
```
Removes the configuration files generated by the build scripts, as well as the
telemetry database files generated by the server at runtime.

## CouchDB
A CouchDB server must be run as a standalone service in order to enable layout persistence.
Download the appropriate version for your system from http://couchdb.apache.org/,
then do the following:
  1. Start the Apache CouchDB application
  2. In a browser, navigate to http://127.0.0.1:5984/_utils/ to open the GUI tools
  3. Go to setup and choose "Setup Single Node"
  4. Configure a username and password, use "127.0.0.1" as the host, and the default port of 5984
  5. From the Databases panel, create a new database called "openmct"
  6. Go to Configuration->CORS, choose "Enable CORS", and add the following URL
      to the allowed domains: http://localhost:8000. This will allow OpenMCT to
      access to the database.

To test that this functionality is working, create a new item, and save it to
"My Items". Then, refresh the browser and observe that the item is persisted.
