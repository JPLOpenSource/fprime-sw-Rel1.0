# Fprime OpenMCT Server

Expands on the openmct-telemetry-server to provide visualizations for binary
data streams. The OpenMCT server consumes a stream of BSON data, publishes it to
clients in real time, and stores it in a database for later historical access.
This deployment runs an adapter to convert fprime binary packets to BSON.
OpenMCT also ships with plugins to use Apache CouchDB to save and persist user-created
resources such as layouts. Telemetry visualization will work without running a CouchDB
server, but any user-created resources cannot be saved.

## Usage

Make sure node.js and npm (https://nodejs.org/en/) are installed on your system,
then from fprime/openmct, run:

```
npm install
```
(Optional): This package ships with a frozen set of the node modules needed
to run the server, but running 'npm install' will update packages if more recent
versions are available.

```
npm run configure
```
Runs autocoders and scripts to generate a JSON dictionary and configuration
files, which are needed by the OpenMCT server and adapter to interpret binary
packets.

```
npm start
```
Starts the OpenMCT telemetry server, web client server, and BSON Adapter. By
default the web client is served on http://localhost:8000

```
npm run clean
```
(Optional) Removes the configuration files generated by the build scripts, as well as the
telemetry database files generated by the server at runtime. Use this to clean up
all generated resources and start from scratch.

## Persistence with CouchDB
A CouchDB server must be run as a standalone service in order to enable layout persistence.
Download the appropriate version for your system from http://couchdb.apache.org/,
then do the following:
  1. Start the Apache CouchDB application
  2. In a browser, navigate to http://127.0.0.1:5984/_utils/ to open the GUI tools
  3. Go to setup and choose "Setup Single Node"
  4. Configure a username and password, use "127.0.0.1" as the host, and the default port of 5984
  5. From the Databases panel, create a new database called "openmct"
  6. Go to Configuration->CORS, choose "Enable CORS", and add http://localhost:8000
      to the allowed domains. This will allow OpenMCT read and write access to the
      database.

To test that this functionality is working, create a new item, and save it to
"My Items". Then, refresh the browser and observe that the item is persisted.
