<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>FPrime</title>    

    <!-- Open MCT Ditribution and plugins -->
    <!-- OMCT -->
    <script src="node_modules/openmct/dist/openmct.js"></script>
    <!-- Server requests -->
    <script src="js/http.js"></script>
    <!-- Get dictionary -->
    <script src="js/get-dict.js"></script>
    <!-- Get dictionary plugin-->
    <script src="plugins/dictionary-plugin.js"></script>
    <!-- Realtime telemetry plugin -->
    <script src="plugins/realtime-telem-plugin.js"></script>
    <!-- Historical telemetry plugin -->
    <script src="plugins/historical-telem-plugin-local.js"></script>
    <!-- Create views from local storage json -->
    <script src="plugins/loc-storage-objects.js"></script>

    <!-- JQuery -->
    <script src="bower_components/jquery/dist/jquery.min.js" type="text/javascript"></script>

    <!-- Command pannel: faketerminal -->
    <link href="bower_components/faketerminal/dist/faketerminal.css" media="all" rel="stylesheet" type="text/css"/>
    <script src="bower_components/faketerminal/dist/faketerminal.min.js" type="text/javascript"></script>

    <!-- Console style -->
    <link href="css/console.css" media="all" rel="stylesheet" type="text/css"/>

    <!-- User commands -->
    <script src="js/console.js"></script>

</head>
<body>
    <script type="text/javascript">
        // Load views
        LoadViews();

        // OpenMCT
        const site = 'localhost';
        const staticPort = 8080;
        const realTelemPort = 1337;
        const histTelemPort = 1338;

        openmct.setAssetPath('node_modules/openmct/dist');
        openmct.install(openmct.plugins.LocalStorage()); // Save user-created views locally
        // openmct.install(openmct.plugins.CouchDB('http://' + site + ':' + histTelemPort.toString()));
        openmct.install(openmct.plugins.MyItems());

        // Configure time system
        openmct.install(openmct.plugins.UTCTimeSystem());
        openmct.install(openmct.plugins.LADTable());
        openmct.install(openmct.plugins.Conductor({
            menuOptions: [
                {
                    name: "Fixed",
                    timeSystem: 'utc',
                    bounds: {
                        start: Date.now() - 5 * 60 * 1000,
                        end: Date.now()
                    }
                },
                {
                    name: "Realtime",
                    timeSystem: 'utc',
                    clock: 'local',
                    clockOffsets: {
                        start: -10 * 60 * 1000,
                        end: 0 * 60 * 1000
                    }
                }
            ]
        }));
        openmct.time.clock('local', {start: -1 * 60 * 1000, end: 0});
        openmct.time.timeSystem('utc');

        // Theme
        openmct.install(openmct.plugins.Snow());

        // User plugin installs
        openmct.install(DictionaryPlugin(site, staticPort));
        openmct.install(RealtimeTelemetryPlugin(site, realTelemPort));
        openmct.install(HistoricalTelemetryPlugin(site, histTelemPort));

        openmct.start();
    </script>

    <div id="command">         
        
        <div id="faketerminal">
            <info>Command Window</info>
            <line></line>
            Enter commands for targets, type <comment>help</comment> to get started

        </div>
        
        <div id="flip">Click to toggle command pannel</div>
        <script type="text/javascript">
            const site = 'localhost';
            const commandPort = 1339;
            SetupCommands(site, commandPort);
        </script>
    </div>
</body>
</html>
